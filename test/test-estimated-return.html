<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Estimated Return Check Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }
    h1 {
      color: #333;
      border-bottom: 1px solid #ddd;
      padding-bottom: 10px;
    }
    .test-section {
      margin-bottom: 30px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .test-section h2 {
      margin-top: 0;
    }
    button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      margin-right: 10px;
    }
    button:hover {
      background-color: #45a049;
    }
    pre {
      background-color: #f5f5f5;
      padding: 10px;
      border-radius: 5px;
      overflow-x: auto;
    }
    .code-block {
      background-color: #f5f5f5;
      padding: 15px;
      border-radius: 5px;
      margin: 15px 0;
      overflow-x: auto;
    }
    #results {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      min-height: 100px;
    }
  </style>
</head>
<body>
  <h1>Estimated Return Check Test</h1>

  <div class="test-section">
    <h2>Test Setup</h2>
    <p>This page allows you to test the estimated return check functionality without having to modify the extension code.</p>
    <p>The test will create a mock bet slip with a specified estimated return value and check if it exceeds the threshold.</p>
  </div>

  <div class="test-section">
    <h2>Step 1: Copy the getEstimatedReturn function</h2>
    <p>Copy the following function and paste it in the console:</p>
    <div class="code-block">
      <pre>
// Get the estimated return value from the bet slip
function getEstimatedReturn() {
  try {
    console.log('Checking estimated return value...');

    // Look for the estimated return element in the footer section
    const estimatedReturnSelectors = [
      // Main selector from the requirement
      'span[font-size="lg"][color="#beff85"] strong',
      // Alternative selectors
      'span[data-testid="estimated-return"]',
      '[data-testid="estimated-return-container"] span:last-child',
      '.estimated-return',
      '.est-return-value'
    ];

    let estimatedReturnElement = null;

    // Try each selector
    for (const selector of estimatedReturnSelectors) {
      const elements = document.querySelectorAll(selector);
      for (const element of elements) {
        // Make sure it's visible and contains a value
        if (element.offsetParent !== null && element.textContent.trim()) {
          estimatedReturnElement = element;
          break;
        }
      }
      if (estimatedReturnElement) break;
    }

    if (!estimatedReturnElement) {
      console.log('Estimated return element not found');
      return null;
    }

    // Extract the text content
    const returnText = estimatedReturnElement.textContent.trim();
    console.log(`Found estimated return text: ${returnText}`);

    // Parse the value (remove currency symbols and commas, convert to number)
    const returnValue = parseFloat(returnText.replace(/[^0-9.]/g, ''));

    if (isNaN(returnValue)) {
      console.log('Could not parse estimated return value');
      return null;
    }

    console.log(`Parsed estimated return value: $${returnValue}`);
    return returnValue;
  } catch (error) {
    console.error('Error getting estimated return:', error);
    return null;
  }
}
      </pre>
    </div>
  </div>

  <div class="test-section">
    <h2>Step 2: Run the tests</h2>
    <button id="testOriginal">Test with Original Threshold ($250,000)</button>
    <button id="testLower">Test with Lower Threshold ($0.05)</button>
    <button id="testCustom">Test with Custom Value</button>
    <input type="number" id="customValue" placeholder="Enter estimated return" value="0.10" style="padding: 10px; margin-left: 10px;">
  </div>

  <div class="test-section">
    <h2>Results</h2>
    <div id="results"></div>
  </div>

  <script>
    // Function to log results
    function logResult(message) {
      const resultsDiv = document.getElementById('results');
      const timestamp = new Date().toLocaleTimeString();
      resultsDiv.innerHTML += `<p>[${timestamp}] ${message}</p>`;
    }

    // Function to create a mock bet slip
    function createMockBetSlip(estimatedReturn) {
      // Remove any existing mock bet slip
      const existingMock = document.getElementById('mock-betslip');
      if (existingMock) {
        document.body.removeChild(existingMock);
      }

      // Create a new mock bet slip
      const mockBetSlip = document.createElement('div');
      mockBetSlip.id = 'mock-betslip';
      mockBetSlip.style.position = 'absolute';
      mockBetSlip.style.left = '-9999px';
      mockBetSlip.innerHTML = `
        <div id="betslip-container">
          <div class="sc-hmjpVf iSRISB">
            <span color="#ffffff" font-size="4xl" class="sc-gsDKAQ cIShPR">Total Stake:&nbsp;<span><strong>$10.00</strong></span></span>
            <span font-size="lg" color="#beff85" class="sc-gsDKAQ dDmkEU">Est. Return:&nbsp;
              <span>
                <strong>$${estimatedReturn.toLocaleString()}</strong>
              </span>
            </span>
          </div>
          <div class="sc-hKwDye fhFVbq">
            <button type="button" data-testid="betslip-place-bet">Place Bets</button>
          </div>
        </div>
      `;

      // Add the mock bet slip to the document
      document.body.appendChild(mockBetSlip);

      return mockBetSlip;
    }

    // Test with original threshold
    document.getElementById('testOriginal').addEventListener('click', function() {
      logResult('Testing with original threshold ($250,000)...');

      // Create a mock bet slip with a high estimated return
      const mockBetSlip = createMockBetSlip(300000);

      // Check if the getEstimatedReturn function is available
      if (typeof window.getEstimatedReturn === 'function') {
        const estimatedReturn = window.getEstimatedReturn();
        logResult(`Estimated return: $${estimatedReturn.toLocaleString()}`);

        // Check if the value exceeds the threshold
        const threshold = 250000;
        if (estimatedReturn > threshold) {
          logResult(`Estimated return exceeds threshold of $${threshold.toLocaleString()}`);
          logResult('Bet would be skipped');
        } else {
          logResult(`Estimated return is below threshold of $${threshold.toLocaleString()}`);
          logResult('Bet would be placed');
        }
      } else {
        logResult('ERROR: getEstimatedReturn function not available. Please copy and paste it in the console first.');
      }
    });

    // Test with lower threshold
    document.getElementById('testLower').addEventListener('click', function() {
      logResult('Testing with extremely low threshold ($0.05)...');

      // Create a mock bet slip with a very small estimated return
      const mockBetSlip = createMockBetSlip(0.10);

      // Check if the getEstimatedReturn function is available
      if (typeof window.getEstimatedReturn === 'function') {
        const estimatedReturn = window.getEstimatedReturn();
        logResult(`Estimated return: $${estimatedReturn.toLocaleString()}`);

        // Check with the extremely low threshold
        const threshold = 0.05;
        if (estimatedReturn > threshold) {
          logResult(`Estimated return exceeds test threshold of $${threshold.toLocaleString()}`);
          logResult('Bet would be skipped with the extremely low threshold');
        } else {
          logResult(`Estimated return is below test threshold of $${threshold.toLocaleString()}`);
          logResult('Bet would be placed with the extremely low threshold');
        }
      } else {
        logResult('ERROR: getEstimatedReturn function not available. Please copy and paste it in the console first.');
      }
    });

    // Test with custom value
    document.getElementById('testCustom').addEventListener('click', function() {
      const customValue = parseFloat(document.getElementById('customValue').value);

      if (isNaN(customValue)) {
        logResult('ERROR: Please enter a valid number for the custom value.');
        return;
      }

      logResult(`Testing with custom value ($${customValue.toLocaleString()})...`);

      // Create a mock bet slip with the custom estimated return
      const mockBetSlip = createMockBetSlip(customValue);

      // Check if the getEstimatedReturn function is available
      if (typeof window.getEstimatedReturn === 'function') {
        const estimatedReturn = window.getEstimatedReturn();
        logResult(`Estimated return: $${estimatedReturn.toLocaleString()}`);

        // Check with all thresholds
        const originalThreshold = 250000;
        const lowerThreshold = 0.05;

        logResult(`Original threshold check ($${originalThreshold.toLocaleString()}):`);
        if (estimatedReturn > originalThreshold) {
          logResult(`- Estimated return exceeds original threshold`);
          logResult('- Bet would be skipped in production');
        } else {
          logResult(`- Estimated return is below original threshold`);
          logResult('- Bet would be placed in production');
        }

        logResult(`Lower threshold check ($${lowerThreshold.toLocaleString()}):`);
        if (estimatedReturn > lowerThreshold) {
          logResult(`- Estimated return exceeds lower threshold`);
          logResult('- Bet would be skipped with the testing threshold');
        } else {
          logResult(`- Estimated return is below lower threshold`);
          logResult('- Bet would be placed with the testing threshold');
        }
      } else {
        logResult('ERROR: getEstimatedReturn function not available. Please copy and paste it in the console first.');
      }
    });
  </script>
</body>
</html>
